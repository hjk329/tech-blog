# 코어 웹 바이탈(Core Web Vitals)로 프론트엔드 웹 최적화하기 - 기본편

코어 웹 바이탈(Core Web Vitals)을 바탕으로 웹 최적화를 했던 경험을 공유합니다.
<br><br>

## 코어 웹 바이탈(Core Web Vitals)이란?
구글은 웹 사이트의 성능을 측정하고 보고하는 다양한 지표와 도구를 제공해 왔다. 2020년에 발표한 코어 웹 바이탈(Core Web Vitals)은 우수한 사용자 경험을 제공하기 위한 핵심적인 메트릭 3개(LCP, FID, CLS)를 포함한다.
<br>

### 메트릭이란?
성능은 상대적일 수 있다. <br> 동일한 사이트를 이용하더라도 빠른 네트워크를 사용하는 사용자는 빠르게, 느린 네트워크를 사용하는 사용자에게는 느리게 동작할 수 있기 때문이다. <br>

따라서, 구글은 성능 측정에 관한 상대성을 줄이고, 정량적으로 측정 가능한 객관적인 기준에서 성능을 비교하고자 했다. 이러한 객관적인 기준을 '메트릭' 이라 칭한다.

2020년을 기준으로 코어 웹 바이탈을 구성하는 메트릭 3개는 아래와 같다.
- LCP(Largest Contentful Paint, 최대 콘텐츠풀 페인트): 로딩 성능을 측정한다. 최적화된 사용자 경험을 제공하기 위해서는 페이지가 처음으로 로딩된 후 2.5초 이내에 LCP 가 발생해야 한다.
- FID(First Input Delay, 최초 입력 지연): 웹 사이트와 사용자의 상호 작용을 측정한다. 우수한 사용자 경험 제공을 위해 페이지의 FID가 100밀리초 이하여야 한다.
- CLS(Cumulative Layout Shift, 누적 레이아웃 시프트): 시각적 안정성을 측정한다. 우수한 사용자 경험을 제공하려면 페이지에서 0.1 이하의 CLS를 유지해야 한다.

각 메트릭에 대한 자세한 내용은 메트릭의 측정 기준 및 도구를 알아본 후에 기술하겠다. <br><br>

## 코어 웹 바이탈 측정 기준
코어 웹 바이탈은 위 3개의 메트릭이 각각 ***75번째 백분위수***인지를 기준으로 웹 사이트의 사용자 경험이 양호한지 아닌지를 판단한다. <br>
이는 웹 사이트의 방문 횟수가 100회라고 했을때 총 75회의 메트릭과 관련한 사용자 경험이 양호하면 해당 메트릭이 좋은 상태라고 판단하고, 그렇지 않으면 해당 메트릭이 열악한 상태로 판단한다는 의미이다. <br> <br>

> 왜 75번째 백분위수를 선택했을까?

구글은 수많은 연구를 통해 75번째 백분위수가 메트릭이 양호한지 아닌지를 가늠할 수 있는 합리적인 숫자라고 판단했다고 한다. <br>

만약 95번째 백분위수를 사용한다면 해당 메트릭이 양호한 상태인지를 더욱 확실하게 알 수도 있다. 예를 들어, 75%의 경험보다 95%의 경험이 우수하다면 목표 수준을 도달했는지 더욱 신빙성을 가질 수 있겠다. <br>

하지만, 이렇게 되면 중앙값에서 떨어져 있는 이상값을 놓칠 우려가 있다. 총 100개 샘플에 대해 95번째 백분위수를 기준으로 한다면 이상값의 영향을 받는 샘플은 단 5개 뿐이기 때문이다. 하지만, 75번째 백분위수를 기준으로 하면 개선할 여지가 있는지 살펴볼 이상값이 25개가 된다.<br>

이처럼 중앙값에서 떨어진 이상값들을 적당히 보고하면서도 안정된 수준의 경험을 제공하는지를 알 수 있는 기준점으로 75번째 백분위수가 가장 적절하다고 판단한 것이다. <br><br>


### 코어 웹 바이탈 측정 도구
코어 웹 바이탈을 측정할 수 있는 도구는 다양하다. 각 도구를 이용하여 우리 프로덕트의 메트릭을 측정해보았다. <br>

- Lighthouse
LCP, CLS를 측정할 수 있다. Lighthouse에서 측정하는 TBT(Total Blocking Time, 총 차단 시간)은 FID와 관련이 깊어서 참고할 수 있다.







